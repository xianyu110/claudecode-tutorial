# 7.14 /compact - 压缩对话历史

## 概述
`/compact` 命令是 Claude Code 的核心命令之一，用于压缩对话历史，保留核心信息，减少 token 消耗，同时保持对话的连贯性。

```
## 基本语法

    bash


    /compact

## 功能说明

```
执行 `/compact` 命令后，Claude Code 会：

  1. 分析当前对话历史
  2. 保留对话的核心信息和上下文
  3. 压缩对话内容，减少 token 数量
  4. 保持对话的连贯性，使 Claude 能够继续理解后续对话

```
## 使用场景

### 1\. 对话过长时压缩

    bash


    # 当对话持续很久，上下文累积过多时
    /compact

    # 压缩对话历史，减少 token 消耗

### 2\. 任务切换前压缩

    bash


    # 在完成一个任务，准备开始新任务前
    /compact

    # 保留核心信息，为新任务腾出上下文空间

### 3\. token 消耗过高时压缩

    bash


    # 当提示 token 消耗过高时
    /compact

    # 降低后续对话的 token 消耗

### 4\. 定期压缩保持效率

    bash


    # 在长时间对话中定期压缩
    /compact

    # 保持对话效率，避免上下文过长

## 注意事项

```
  1. `/compact` 命令无任何参数，执行后会自动压缩对话历史
  2. 压缩过程会保留对话的核心信息和上下文
  3. 压缩后无法恢复原始对话历史
  4. 压缩可以显著减少 token 消耗，提高对话效率
  5. 不会影响已生成的 `CLAUDE.md` 文件或其他项目文件

```
## 与其他命令的组合

    bash


    # 压缩对话历史后，开始新的对话
    /compact
    /clear

    # 执行流程：
    # 1. 压缩对话历史，保留核心信息
    # 2. 清空历史对话，开始全新的对话
    # 3. 新对话会保留压缩后的核心信息

## 最佳实践

```
  1. **对话过长时使用** ：当对话超过 20 轮或 token 消耗过高时，建议使用 `/compact`
  2. **任务切换前使用** ：在完成一个任务，准备开始新任务前使用 `/compact`
  3. **定期使用** ：在长时间对话中，每完成一个子任务后使用 `/compact`
  4. **结合 /clear 使用** ：在需要完全重置对话时，先使用 `/compact` 保留核心信息，再使用 `/clear` 清空对话

## 总结
`/compact` 命令是 Claude Code 中用于管理对话历史的重要命令。通过使用此命令，你可以：

  * 压缩对话历史，减少 token 消耗
  * 保留对话的核心信息和上下文
  * 提高对话效率
  * 为新任务腾出上下文空间

合理使用 `/compact` 命令可以帮助你在与 Claude Code 交互时保持高效，减少不必要的 token 消耗。