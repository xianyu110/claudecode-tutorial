# 5.4 `cat file | claude -p "query"` - 處理管道內容

透過管道將檔案內容傳遞給 Claude Code 進行處理，這是一種強大的工作流，允許您將其他命令的輸出直接傳遞給 Claude Code。

```
## 命令语法

    bash


    cat file | claude -p "query" [选项]

```
或使用其他命令的輸出：

```
    bash


    command | claude -p "query" [选项]

## 功能描述

```
透過管道（`|`）將左側命令的輸出傳遞給右側的 `claude -p` 命令。這允許您：

  * 將檔案內容傳遞給 Claude Code 處理
  * 將其他命令的輸出傳遞給 Claude Code
  * 構建複雜的資料處理管道
  * 實現自動化的工作流

```
## 使用示例

### 基本用法

    bash


    cat logs.txt | claude -p "解释这些日志"

```
將 logs.txt 檔案的內容傳遞給 Claude Code，請求解釋日誌。

```
### 代码分析

    bash


    cat main.js | claude -p "分析这段代码的质量"

```
將 main.js 的內容傳遞給 Claude Code，請求程式碼質量分析。

```
### 错误日志分析

    bash


    cat error.log | claude -p "找出这些错误的原因"

```
將錯誤日誌傳遞給 Claude Code，請求分析錯誤原因。

```
### Git 输出处理

    bash


    git diff | claude -p "总结这些代码变更"

```
將 git diff 的輸出傳遞給 Claude Code，請求總結程式碼變更。

```
### 结合其他命令

    bash


    grep "error" app.log | claude -p "分析这些错误模式"

```
先使用 grep 過濾錯誤日誌，然後將結果傳遞給 Claude Code 分析。

```bash
### 列出文件类型

    bash


    ls -la | claude -p "列出这些文件的类型"

```
將 ls 命令的輸出傳遞給 Claude Code，請求分析檔案型別。

```
## 管道的优势

### 1\. 灵活性

```
可以組合多個命令，構建複雜的資料處理流程。

### 2\. 自動化
適合在指令碼和自動化流程中使用，無需手動複製貼上。

### 3\. 效率
避免中間檔案，直接在命令之間傳遞資料。

### 4\. 整合
可以輕鬆整合到現有的 Unix/Linux 命令列工具鏈中。

```
## 常用场景

### 1\. 日志分析

    bash


    cat application.log | claude -p "分析这些日志，找出性能问题"

```
分析應用程式日誌，找出效能問題。

```
### 2\. 代码审查

    bash


    git diff HEAD~1 | claude -p "审查这些代码变更"

```
審查最近的程式碼變更。

```
### 3\. 文档生成

    bash


    cat api.py | claude -p "为这个 API 生成文档"

```
為 API 程式碼生成文件。

```
### 4\. 数据转换

    bash


    cat data.csv | claude -p "将 CSV 转换为 JSON" --output-format json

```
將 CSV 資料轉換為 JSON 格式。

```
### 5\. 错误调试

    bash


    cat stacktrace.txt | claude -p "分析这个堆栈跟踪"

```
分析堆疊跟蹤，幫助除錯錯誤。

```
## 高级用法

### 多重管道

    bash


    cat file.txt | grep "pattern" | claude -p "处理匹配的内容"

```
使用多個管道，先過濾再處理。

```
### 结合重定向

    bash


    cat input.txt | claude -p "处理内容" > output.txt

```
將處理結果重定向到檔案。

```
### 错误流处理

    bash


    command 2>&1 | claude -p "处理所有输出"

```
將標準輸出和錯誤輸出都傳遞給 Claude Code。

```
### 后台执行

    bash


    cat largefile.txt | claude -p "处理大文件" &

```
在後臺處理大檔案。

## 注意事項
  1. **輸出格式** ：確保傳遞給 Claude Code 的內容是合適的格式
  2. **編碼問題** ：注意檔案的編碼，避免亂碼
  3. **大小限制** ：大檔案可能需要分批處理
  4. **特殊字元** ：某些特殊字元可能需要轉義
  5. **錯誤處理** ：管道中的任何命令失敗都會導致整個管道失敗

## 管道最佳實踐
  1. **驗證輸出** ：先驗證左側命令的輸出是否符合預期
  2. **使用合適的格式** ：確保傳遞的內容格式正確
  3. **處理錯誤** ：考慮管道中命令失敗的情況
  4. **效能考慮** ：大檔案處理可能需要最佳化
  5. **日誌記錄** ：記錄管道的輸入和輸出，便於除錯

## 與其他方法的對比
方法| 優點| 缺點| 適用場景
---|---|---|---
管道| 靈活、可組合、自動化| 需要命令列知識| 指令碼、自動化
檔案引數| 簡單、直觀| 需要中間檔案| 簡單任務
互動式輸入| 靈活、可調整| 不適合自動化| 探索性任務

## 相關命令
  * `claude -p`：透過 SDK 查詢，然後退出
  * `cat`：顯示檔案內容
  * `grep`：搜尋文字模式
  * `git diff`：顯示程式碼變更
  * `--input-format`：指定輸入格式

```bash
## 实际应用示例

### CI/CD 代码审查

    sh


    #!/bin/bash
    # 获取最近的代码变更
    changes=$(git diff origin/main...HEAD)
    # 通过管道传递给 Claude Code 进行审查
    echo "$changes" | claude -p "审查这些代码变更" --output-format json > review.json

### 日志监控脚本

    sh


    #!/bin/bash
    # 监控日志文件
    tail -f app.log | while read line; do
    echo "$line" | claude -p "分析这行日志"
    done

### 批量文档生成

    sh


    #!/bin/bash
    # 为多个文件生成文档
    for file in src/*.py; do
      cat "$file" | claude -p "为这个文件生成文档" > "docs/${file##*/}.md"
    done

```
透過管道，您可以構建強大而靈活的工作流，將 Claude Code 無縫整合到您的開發和運維流程中。