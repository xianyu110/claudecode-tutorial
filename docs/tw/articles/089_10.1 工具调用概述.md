# 10.1 工具呼叫概述

Claude Code 的工具呼叫系統是其核心功能之一，它允許 Claude 執行各種操作來幫助您完成開發任務。透過工具呼叫，Claude 可以與外部系統互動，執行檔案操作、執行命令、搜尋程式碼庫等，極大地擴充套件了其能力範圍。

## 什麼是工具呼叫

工具呼叫是 Claude Code 與外部世界互動的機制。透過工具呼叫，Claude 可以：

  * **讀取和寫入檔案** : 檢視和修改專案中的程式碼和配置檔案
  * **執行命令列操作** : 執行 shell 命令、構建工具和其他開發工具
  * **搜尋程式碼庫** : 查詢特定模式、函式或類的位置
  * **管理專案** : 執行 Git 操作、包管理和容器操作
  * **與外部服務整合** : 連線到 API、資料庫和其他服務

## 工具呼叫的優勢

  1. **自動化** : 自動執行重複性任務，提高工作效率
  2. **準確性** : 減少人為錯誤，確保操作一致性
  3. **效率** : 快速完成複雜操作，節省時間
  4. **整合** : 與各種工具和服務無縫整合，形成完整的開發工作流
  5. **可擴充套件性** : 支援自定義工具開發，滿足特定需求

## 工具呼叫流程

Claude Code 的工具呼叫遵循以下流程：

  1. **使用者請求** : 使用者提出需求或問題
  2. **Claude 分析** : Claude 理解使用者需求，確定需要執行的操作
  3. **選擇工具** : 根據需求選擇合適的工具
  4. **執行操作** : 呼叫工具執行指定操作
  5. **返回結果** : 工具返回執行結果
  6. **使用者確認** : 向使用者展示結果，等待確認或進一步指示

## 工具分類

Claude Code 提供了豐富的工具集，可以分為以下幾類：

### 1\. 檔案操作工具

工具| 描述
---|---

**Read**|  讀取檔案內容
**Write**|  寫入檔案內容
**Edit**|  編輯檔案內容
**Delete**|  刪除檔案
**Glob**|  按模式查詢檔案

### 2\. 搜尋工具

工具| 描述
---|---

**Grep**|  在檔案中搜尋文字模式
**SearchCodebase**|  語義搜尋程式碼庫，查詢相關程式碼片段
**Find**|  查詢檔案和目錄

### 3\. 命令執行工具

工具| 描述
---|---

**Bash**|  執行 shell 命令
**RunCommand**|  執行特定命令或指令碼
**Background**|  在後臺執行命令

### 4\. 專案管理工具

工具| 描述
---|---

**Git**|  執行 Git 操作（提交、推送、拉取等）
**NPM**|  執行 NPM 操作（安裝、更新、構建等）
**Docker**|  執行 Docker 操作（構建、執行、推送等）
**Yarn**|  執行 Yarn 包管理操作

### 5\. 整合工具

工具| 描述
---|---

**MCP**|  模型上下文協議整合，與外部服務互動
**Plugins**|  外掛工具，擴充套件 Claude 功能
**Skills**|  技能工具，提供特定領域的專業知識
**APIClient**|  API 客戶端，與外部 API 互動

## 工具許可權

Claude Code 提供了多層許可權控制，確保工具呼叫的安全性和可控性。

### 許可權模式


  * **自動接受模式** : 自動批准所有工具呼叫，適合信任環境
  * **計劃模式** : 顯示計劃但不執行，用於預覽操作
  * **正常模式** : 每次工具呼叫都需要使用者確認，確保安全性

### 工具白名單/黑名單

您可以透過命令列引數控制允許或禁止使用的工具：

```
    bash


    # 允许特定工具
    claude --allowedTools Read,Grep,Glob

    # 禁止特定工具
    claude --disallowedTools Bash,Write

### 权限配置文件

```

您還可以透過配置檔案更精細地控制工具許可權：

```
    json


    {
      "allowedTools": ["Read", "Grep", "Git"],
      "disallowedTools": ["Write", "Delete"],
      "permissionMode": "normal"
    }

## 工具调用示例

### 1\. 读取文件

    bash


    读取 package.json 文件
    [Read tool called]
    {
      "name": "my-project",
      "version": "1.0.0",
      "dependencies": {
        "react": "^18.0.0",
        "react-dom": "^18.0.0"
      }
    }

### 2\. 搜索代码

    bash


    搜索所有包含 "TODO" 的文件
    [Grep tool called]
    Found 5 files with TODO comments:
    - src/App.js: // TODO: Add error handling
    - src/utils.js: // TODO: Optimize performance
    - tests/unit.test.js: // TODO: Write more tests

### 3\. 执行命令

    bash


    运行 npm install
    [Bash tool called]
    npm install
    added 1423 packages in 2m
    found 0 vulnerabilities

### 4\. Git 操作

    bash


    提交更改
    [Git tool called]
    git commit -m "Add new feature"
    [main 1234567] Add new feature
     2 files changed, 10 insertions(+), 2 deletions(-)

## 工具调用最佳实践

```

  1. **明確請求** : 清楚地說明您需要什麼，提供足夠的上下文
  2. **分步執行** : 將複雜任務分解為多個步驟，逐步完成
  3. **確認操作** : 在執行破壞性操作（如刪除檔案）前，確認操作的安全性
  4. **使用描述性名稱** : 為檔案和變數使用清晰的名稱，便於搜尋和理解
  5. **監控輸出** : 對於長時間執行的命令，定期檢查輸出以確保正常執行
  6. **限制許可權** : 根據需要限制工具許可權，確保安全性
  7. **使用批次操作** : 對於相似的操作，使用批次處理提高效率

## 工具呼叫限制

雖然 Claude Code 的工具呼叫功能強大，但也存在一些限制：

  1. **資源限制** : 工具呼叫可能受系統資源限制，如記憶體、CPU 等
  2. **網路限制** : 網路操作可能受網路連線和頻寬限制
  3. **許可權限制** : 某些操作可能需要特定的系統許可權
  4. **安全限制** : 為了安全，某些危險操作可能被預設禁止
  5. **效能限制** : 對於大型程式碼庫，搜尋和分析可能需要較長時間

## 未來發展

Claude Code 的工具呼叫系統正在不斷發展，未來可能會增加以下功能：

  1. **更多工具** : 增加更多內建工具，覆蓋更多開發場景
  2. **更好的整合** : 與更多開發工具和服務無縫整合
  3. **智慧推薦** : 根據上下文智慧推薦合適的工具
  4. **自定義工具** : 支援使用者開發和整合自定義工具
  5. **協作功能** : 支援多人協作使用工具

透過不斷改進和擴充套件，Claude Code 的工具呼叫系統將成為開發者不可或缺的助手，幫助您更高效地完成開發任務。

  * 某些操作可能需要額外許可權
  * 工具呼叫可能受速率限制
  * 某些工具可能有使用限制
  * 網路操作可能受限

## 扩展工具调用

### 自定义工具


您可以透過以下方式擴充套件工具呼叫：

  1. **外掛** : 建立自定義外掛
  2. **Skills** : 開發技能
  3. **MCP** : 整合 MCP 伺服器

### 整合外部服務

透過 MCP 伺服器整合外部服務：

```
    bash


    /mcp add github

    # 使用 GitHub 工具创建 PR
    创建 PR #123

    ```## 監控工具呼叫

    ### 查看工具使用情况

    显示最近的工具调用
    最近工具调用：
    - Read: package.json
    - Bash: npm install
    - Grep: "TODO"

### 调试工具调用

    bash


```

    ```bash

    claude --verbose


    ## 故障排除

    ### 工具调用失败

    1. 检查权限设置
    2. 确认工具可用
    3. 查看错误消息
    4. 检查日志

    ### 工具不执行

    1. 确认权限模式
    2. 检查工具白名单
    3. 验证命令语法
    4. 查看详细输出


    ```

```

```
